{"componentChunkName":"component---src-templates-blog-post-tsx","path":"/cssattributedstring-in-swift","result":{"data":{"site":{"siteMetadata":{"title":"ilyagru","author":"Ilya Gruzhevski","siteUrl":"https://ilyagru.com"}},"markdownRemark":{"id":"4f3a81c7-b64d-52c7-b243-0beee28d667a","excerpt":"An interesting alternative to managing your s in Swift projects. For those who know the CSS styles well. Motivation It is just an interesting approach. Maybe for some of you it could be simpler since it seems that everybody knows the CSS styles by heart. Also, it could be useful if you need to share…","html":"<p>An interesting alternative to managing your <code class=\"language-text\">NSAttributedString</code>s in Swift projects. For those who know the CSS styles well.</p>\n<h2>Motivation</h2>\n<p>It is just an interesting approach. Maybe for some of you it could be simpler since it seems that everybody knows the CSS styles by heart. Also, it could be useful if you need to share the same styles with the Frontend codebase. I think, there are some cases where it could be helpful, for example when we have a Wikipedia-like page or a document with different headers, different types of text.</p>\n<h2>Classical approach</h2>\n<p>This is how it is done classically. We create <code class=\"language-text\">NSAttributedString</code> and then just add necessary attributes. It is clear that classical doesn’t mean bad. It is typed at least.</p>\n<div class=\"gatsby-highlight\" data-language=\"swift\"><pre class=\"language-swift\"><code class=\"language-swift\"><span class=\"token keyword\">let</span> text <span class=\"token operator\">=</span> <span class=\"token string-literal\"><span class=\"token string\">\"Excusez-moi, ça ne vous embête pas que je vous observe une minute? Je veux me souvenir de votre visage pour mes rêves.\"</span></span>\n\n<span class=\"token keyword\">let</span> font <span class=\"token operator\">=</span> <span class=\"token class-name\">UIFont</span><span class=\"token punctuation\">.</span><span class=\"token function\">systemFont</span><span class=\"token punctuation\">(</span>ofSize<span class=\"token punctuation\">:</span> <span class=\"token number\">24</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">let</span> paragraphStyle <span class=\"token operator\">=</span> <span class=\"token class-name\">NSMutableParagraphStyle</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nparagraphStyle<span class=\"token punctuation\">.</span>firstLineHeadIndent <span class=\"token operator\">=</span> <span class=\"token number\">4.0</span>\nparagraphStyle<span class=\"token punctuation\">.</span>alignment <span class=\"token operator\">=</span> <span class=\"token punctuation\">.</span>center\n\n<span class=\"token keyword\">let</span> attributes<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token class-name\">NSAttributedString</span><span class=\"token punctuation\">.</span><span class=\"token class-name\">Key</span><span class=\"token punctuation\">:</span> <span class=\"token keyword\">Any</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token punctuation\">.</span>font<span class=\"token punctuation\">:</span> font<span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">.</span>foregroundColor<span class=\"token punctuation\">:</span> <span class=\"token class-name\">UIColor</span><span class=\"token punctuation\">.</span>green<span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">.</span>paragraphStyle<span class=\"token punctuation\">:</span> paragraphStyle\n<span class=\"token punctuation\">]</span>\n\n<span class=\"token keyword\">let</span> attributedText <span class=\"token operator\">=</span> <span class=\"token class-name\">NSAttributedString</span><span class=\"token punctuation\">(</span>string<span class=\"token punctuation\">:</span> text<span class=\"token punctuation\">,</span> attributes<span class=\"token punctuation\">:</span> attributes<span class=\"token punctuation\">)</span></code></pre></div>\n<h2>CSSAttributedString approach</h2>\n<p>This is how you can do if you want to change the look of text with the help of CSS.</p>\n<h3>Make us ready</h3>\n<p>First of all, you need to add a convenience <code class=\"language-text\">init</code> method to the <code class=\"language-text\">NSAttributedString</code> object. So you can initialize attributed strings in a simple way. Here I use the <code class=\"language-text\">&lt;p>&lt;/p></code> tag because it is a basic text element. Don’t forget that the tags could have the <a href=\"http://trac.webkit.org/browser/trunk/Source/WebCore/css/html.css\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">default browser styles</a> like the default font for the text. In case of the <code class=\"language-text\">&lt;p></code>, it is a block element by default. It means that it always starts on a new line, and fills up the horizontal space to the left and right. Every next element will be rendered below.</p>\n<div class=\"gatsby-highlight\" data-language=\"swift\"><pre class=\"language-swift\"><code class=\"language-swift\"><span class=\"token keyword\">extension</span> <span class=\"token class-name\">NSAttributedString</span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token keyword\">convenience</span> <span class=\"token keyword\">init</span><span class=\"token punctuation\">(</span>text<span class=\"token punctuation\">:</span> <span class=\"token class-name\">String</span><span class=\"token punctuation\">,</span> styles<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">:</span> <span class=\"token class-name\">String</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\n        <span class=\"token comment\">// Prepare a style string for passing to the HTML attribute</span>\n        <span class=\"token comment\">// So the final value of the style attribute will look like this</span>\n        <span class=\"token comment\">// \"color: #000;font-size: 12px;font-family: Helvetica;font-style: italic\"</span>\n        <span class=\"token keyword\">let</span> style <span class=\"token operator\">=</span> styles<span class=\"token punctuation\">.</span><span class=\"token function\">compactMap</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> <span class=\"token punctuation\">(</span>property<span class=\"token punctuation\">,</span> value<span class=\"token punctuation\">)</span> <span class=\"token operator\">-></span> <span class=\"token class-name\">String</span> <span class=\"token keyword\">in</span>\n            <span class=\"token keyword\">return</span> <span class=\"token string-literal\"><span class=\"token string\">\"</span><span class=\"token interpolation-punctuation punctuation\">\\(</span><span class=\"token interpolation\">property</span><span class=\"token interpolation-punctuation punctuation\">)</span><span class=\"token string\">: </span><span class=\"token interpolation-punctuation punctuation\">\\(</span><span class=\"token interpolation\">value</span><span class=\"token interpolation-punctuation punctuation\">)</span><span class=\"token string\">\"</span></span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">joined</span><span class=\"token punctuation\">(</span>separator<span class=\"token punctuation\">:</span> <span class=\"token string-literal\"><span class=\"token string\">\";\"</span></span><span class=\"token punctuation\">)</span>\n\n        <span class=\"token comment\">// Initialize from the styled &lt;p> HTML tag</span>\n        <span class=\"token comment\">// We can force-unwrap this because in case of incorrect styles the string will be initialized anyway</span>\n        <span class=\"token keyword\">try</span><span class=\"token operator\">!</span> <span class=\"token keyword\">self</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">init</span><span class=\"token punctuation\">(</span>\n            data<span class=\"token punctuation\">:</span> <span class=\"token class-name\">Data</span><span class=\"token punctuation\">(</span><span class=\"token string-literal\"><span class=\"token string\">\"&lt;p style=\\\"</span><span class=\"token interpolation-punctuation punctuation\">\\(</span><span class=\"token interpolation\">style</span><span class=\"token interpolation-punctuation punctuation\">)</span><span class=\"token string\">\\\"></span><span class=\"token interpolation-punctuation punctuation\">\\(</span><span class=\"token interpolation\">text</span><span class=\"token interpolation-punctuation punctuation\">)</span><span class=\"token string\">&lt;/p>\"</span></span><span class=\"token punctuation\">.</span>utf8<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n            options<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">.</span>documentType<span class=\"token punctuation\">:</span> <span class=\"token class-name\">NSAttributedString</span><span class=\"token punctuation\">.</span><span class=\"token class-name\">DocumentType</span><span class=\"token punctuation\">.</span>html<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">.</span>characterEncoding<span class=\"token punctuation\">:</span> <span class=\"token class-name\">String</span><span class=\"token punctuation\">.</span><span class=\"token class-name\">Encoding</span><span class=\"token punctuation\">.</span>utf8<span class=\"token punctuation\">.</span>rawValue<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n            documentAttributes<span class=\"token punctuation\">:</span> <span class=\"token nil constant\">nil</span>\n        <span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>So now you can create your styled strings like this. All the properties supported in Safari must be supported here as well! By the way, to use the same font as in iOS you can provide <code class=\"language-text\">-apple-system, system-ui</code> to the <code class=\"language-text\">font-family</code> property. So it will automatically use the San-Francisco font. It looks quite nice, huh?</p>\n<div class=\"gatsby-highlight\" data-language=\"swift\"><pre class=\"language-swift\"><code class=\"language-swift\"><span class=\"token keyword\">let</span> header <span class=\"token operator\">=</span> <span class=\"token class-name\">NSAttributedString</span><span class=\"token punctuation\">(</span>\n    text<span class=\"token punctuation\">:</span> <span class=\"token string-literal\"><span class=\"token string\">\"This is a Header with CSS, hoorah!\"</span></span><span class=\"token punctuation\">,</span>\n    styles<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>\n        <span class=\"token string-literal\"><span class=\"token string\">\"color\"</span></span> <span class=\"token punctuation\">:</span> <span class=\"token string-literal\"><span class=\"token string\">\"#89da20\"</span></span><span class=\"token punctuation\">,</span>\n        <span class=\"token string-literal\"><span class=\"token string\">\"font-size\"</span></span><span class=\"token punctuation\">:</span> <span class=\"token string-literal\"><span class=\"token string\">\"24px\"</span></span><span class=\"token punctuation\">,</span>\n        <span class=\"token string-literal\"><span class=\"token string\">\"font-family\"</span></span><span class=\"token punctuation\">:</span> <span class=\"token string-literal\"><span class=\"token string\">\"-apple-system, system-ui\"</span></span>\n    <span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">)</span></code></pre></div>\n<h2>Better structure</h2>\n<p>Of course, we can go further. We can prepare mappings for our headers, bodies, captions, etc. In case of complex content you can create a whole system for styling with flexbox, etc. I haven’t tested all the CSS properties, so try your hand on.</p>\n<div class=\"gatsby-highlight\" data-language=\"swift\"><pre class=\"language-swift\"><code class=\"language-swift\"><span class=\"token keyword\">enum</span> <span class=\"token class-name\">Styles</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">static</span> <span class=\"token keyword\">let</span> header <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>\n        <span class=\"token string-literal\"><span class=\"token string\">\"color\"</span></span> <span class=\"token punctuation\">:</span> <span class=\"token string-literal\"><span class=\"token string\">\"#89da20\"</span></span><span class=\"token punctuation\">,</span>\n        <span class=\"token string-literal\"><span class=\"token string\">\"font-size\"</span></span><span class=\"token punctuation\">:</span> <span class=\"token string-literal\"><span class=\"token string\">\"24px\"</span></span><span class=\"token punctuation\">,</span>\n        <span class=\"token string-literal\"><span class=\"token string\">\"font-family\"</span></span><span class=\"token punctuation\">:</span> <span class=\"token string-literal\"><span class=\"token string\">\"-apple-system, system-ui\"</span></span>\n    <span class=\"token punctuation\">]</span>\n    <span class=\"token keyword\">static</span> <span class=\"token keyword\">let</span> body <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>\n        <span class=\"token string-literal\"><span class=\"token string\">\"color\"</span></span> <span class=\"token punctuation\">:</span> <span class=\"token string-literal\"><span class=\"token string\">\"#333\"</span></span><span class=\"token punctuation\">,</span>\n        <span class=\"token string-literal\"><span class=\"token string\">\"font-size\"</span></span><span class=\"token punctuation\">:</span> <span class=\"token string-literal\"><span class=\"token string\">\"16px\"</span></span><span class=\"token punctuation\">,</span>\n        <span class=\"token string-literal\"><span class=\"token string\">\"font-family\"</span></span><span class=\"token punctuation\">:</span> <span class=\"token string-literal\"><span class=\"token string\">\"-apple-system, system-ui\"</span></span>\n    <span class=\"token punctuation\">]</span>\n    <span class=\"token keyword\">static</span> <span class=\"token keyword\">let</span> caption <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>\n        <span class=\"token string-literal\"><span class=\"token string\">\"color\"</span></span> <span class=\"token punctuation\">:</span> <span class=\"token string-literal\"><span class=\"token string\">\"#666\"</span></span><span class=\"token punctuation\">,</span>\n        <span class=\"token string-literal\"><span class=\"token string\">\"font-size\"</span></span><span class=\"token punctuation\">:</span> <span class=\"token string-literal\"><span class=\"token string\">\"12px\"</span></span><span class=\"token punctuation\">,</span>\n        <span class=\"token string-literal\"><span class=\"token string\">\"font-family\"</span></span><span class=\"token punctuation\">:</span> <span class=\"token string-literal\"><span class=\"token string\">\"-apple-system, system-ui\"</span></span><span class=\"token punctuation\">,</span>\n        <span class=\"token string-literal\"><span class=\"token string\">\"font-style\"</span></span><span class=\"token punctuation\">:</span> <span class=\"token string-literal\"><span class=\"token string\">\"italic\"</span></span><span class=\"token punctuation\">,</span>\n        <span class=\"token string-literal\"><span class=\"token string\">\"text-align\"</span></span><span class=\"token punctuation\">:</span> <span class=\"token string-literal\"><span class=\"token string\">\"right\"</span></span>\n    <span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">let</span> header <span class=\"token operator\">=</span> <span class=\"token class-name\">NSAttributedString</span><span class=\"token punctuation\">(</span>text<span class=\"token punctuation\">:</span> <span class=\"token string-literal\"><span class=\"token string\">\"Le Mourillon\"</span></span><span class=\"token punctuation\">,</span> styles<span class=\"token punctuation\">:</span> <span class=\"token class-name\">Styles</span><span class=\"token punctuation\">.</span>header<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">let</span> body <span class=\"token operator\">=</span> <span class=\"token class-name\">NSAttributedString</span><span class=\"token punctuation\">(</span>\n    text<span class=\"token punctuation\">:</span> <span class=\"token string-literal\"><span class=\"token string\">\"Le Mourillon est un des quartiers de l'Est de Toulon dont les hauteurs appartiennent à la Provence cristalline. C'est un véritable village provençal enclavé dans la ville toulonnaise, disposant de plusieurs monuments historiques (forts), églises, places, d'un musée (arts asiatiques), de son marché quotidien et de ses diverses rues commerçantes.\"</span></span><span class=\"token punctuation\">,</span>\n    styles<span class=\"token punctuation\">:</span> <span class=\"token class-name\">Styles</span><span class=\"token punctuation\">.</span>body\n<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">let</span> caption <span class=\"token operator\">=</span> <span class=\"token class-name\">NSAttributedString</span><span class=\"token punctuation\">(</span>text<span class=\"token punctuation\">:</span> <span class=\"token string-literal\"><span class=\"token string\">\"https://fr.wikipedia.org/wiki/Le_Mourillon\"</span></span><span class=\"token punctuation\">,</span> styles<span class=\"token punctuation\">:</span> <span class=\"token class-name\">Styles</span><span class=\"token punctuation\">.</span>caption<span class=\"token punctuation\">)</span></code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 650px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/9da7804a587a77a1c1451877023549db/58c38/cssattributedstring-screenshot.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 49.079754601226995%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsTAAALEwEAmpwYAAABy0lEQVQoz32Sz2saQRTHZ8GmkGrS4q8ka0zbew7pMTk099JrDAglvehqEqh1taU0pJBLD4J6yN+wYXbI/j1md5NKFUM0jUVxwc7OK29RoQX3wQxf5r33eV8eQ8h/8an8WVKLJbL7evftwbv35+vyRi0SjtYjkUhdluVaOp0+39neeZPJZIiiKBLxi/3U/lSG6vVa98dPC75XzuDryRc4Pf0G1WoVWq0WVCqVLiEkiIWpvdR84PHRsTdxIfA4YRiXXQAXAJwxAPyZHNRgGAYC41ibzWTnuywWPkrBxUUSj8YSmqb1et17sEzbvbm+EbZti0aj4Q4GA6CU3hFCotijZH2ApaIqhZ+FSTKRTF5oF/edTgeuzCvXNE2wbRssy0LLoOv6r6dLy+sLgUdELao+QLUkxaMx8vL5iw1N0zwgusK9tdttaDabruM4CHxYW1lNLoeWSLlUng8sfChImA09Cco61Xvopt/vu6PRSDiOI4bDoeeQUjrbYT6Xmw/MK7NkjDF2i81CCM45x0uMx2M+Ac52mMv6fJ3DXH6aXGGMPWAz5x7DC9f1DIJO6W8c6gEVf+BUBhhjmwDwinO+JYTwDmp8o5RuYs0E+A/kLyjOICP3uFVwAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"CSSAttributedString screenshot\"\n        title=\"CSSAttributedString screenshot\"\n        src=\"/static/9da7804a587a77a1c1451877023549db/663f3/cssattributedstring-screenshot.png\"\n        srcset=\"/static/9da7804a587a77a1c1451877023549db/5e043/cssattributedstring-screenshot.png 163w,\n/static/9da7804a587a77a1c1451877023549db/e5cc6/cssattributedstring-screenshot.png 325w,\n/static/9da7804a587a77a1c1451877023549db/663f3/cssattributedstring-screenshot.png 650w,\n/static/9da7804a587a77a1c1451877023549db/d880f/cssattributedstring-screenshot.png 975w,\n/static/9da7804a587a77a1c1451877023549db/58c38/cssattributedstring-screenshot.png 1260w\"\n        sizes=\"(max-width: 650px) 100vw, 650px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>You can implement a concatenation method for <code class=\"language-text\">NSAttributedString</code>s, so you can join strings with the plus sign.</p>\n<div class=\"gatsby-highlight\" data-language=\"swift\"><pre class=\"language-swift\"><code class=\"language-swift\"><span class=\"token keyword\">extension</span> <span class=\"token class-name\">NSAttributedString</span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token keyword\">static</span> <span class=\"token keyword\">func</span> <span class=\"token operator\">+</span><span class=\"token punctuation\">(</span>lhs<span class=\"token punctuation\">:</span> <span class=\"token class-name\">NSAttributedString</span><span class=\"token punctuation\">,</span> rhs<span class=\"token punctuation\">:</span> <span class=\"token class-name\">NSAttributedString</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-></span> <span class=\"token class-name\">NSAttributedString</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">let</span> concatenatedString <span class=\"token operator\">=</span> <span class=\"token class-name\">NSMutableAttributedString</span><span class=\"token punctuation\">(</span>attributedString<span class=\"token punctuation\">:</span> lhs<span class=\"token punctuation\">)</span>\n        concatenatedString<span class=\"token punctuation\">.</span><span class=\"token function\">append</span><span class=\"token punctuation\">(</span>rhs<span class=\"token punctuation\">)</span>\n\n        <span class=\"token keyword\">return</span> concatenatedString\n    <span class=\"token punctuation\">}</span>\n\n<span class=\"token punctuation\">}</span>\n\ntextView<span class=\"token punctuation\">.</span>attributedText <span class=\"token operator\">=</span> header <span class=\"token operator\">+</span> body <span class=\"token operator\">+</span> caption</code></pre></div>\n<h2>Conclusion</h2>\n<p>So simply experiment with this. And maybe you could find it a good fit to your project. However, have fun!</p>\n<h2>References</h2>\n<ol>\n<li><a href=\"https://developer.apple.com/documentation/foundation/nsattributedstring\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">NSAttributedString Apple Documentation</a></li>\n<li><a href=\"https://www.w3schools.com/cssref/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">W3Schools CSS reference</a></li>\n</ol>","frontmatter":{"title":"CSSAttributedString in Swift","date":"May 05, 2019","summary":"An interesting approach to managing your NSAttributedStrings in Swift projects. For those who know the CSS styles well.","featuredImage":{"childImageSharp":{"gatsbyImageData":{"layout":"fixed","backgroundColor":"#f8f8f8","images":{"fallback":{"src":"/static/ab5c9e4f12cca1ec18982d793c125c60/92871/cssattributedstring-in-swift-featured-image.png","srcSet":"/static/ab5c9e4f12cca1ec18982d793c125c60/92871/cssattributedstring-in-swift-featured-image.png 1143w","sizes":"1142.857142857143px"},"sources":[{"srcSet":"/static/ab5c9e4f12cca1ec18982d793c125c60/eed13/cssattributedstring-in-swift-featured-image.webp 1143w","type":"image/webp","sizes":"1142.857142857143px"}]},"width":1200,"height":630}}}}}},"pageContext":{"slug":"cssattributedstring-in-swift","source":"blog","previous":{"fields":{"slug":"react-context-toaster","source":"blog"},"frontmatter":{"title":"Toast messages mechanism in React Native using React Context"}},"next":{"fields":{"slug":"AUTOmation","source":"blog"},"frontmatter":{"title":"When automation becomes AUTOmation"}}}},"staticQueryHashes":["3128451518","4268320825","637957696"]}