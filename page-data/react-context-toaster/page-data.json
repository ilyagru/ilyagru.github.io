{"componentChunkName":"component---src-templates-blog-post-tsx","path":"/react-context-toaster","result":{"data":{"site":{"siteMetadata":{"title":"ilyagru","author":"Ilya Gruzhevski","siteUrl":"https://ilyagru.com"}},"markdownRemark":{"id":"ab0caa74-0527-52a2-a735-af06188fe8d5","excerpt":"Introduction Toasts are lightweight notifications designed to mimic the push notifications. They have been popularized by mobile and desktop operating systems. They’re used mainly internally, in-app to provide users with some feedback about errors, successfully completed actions, etc. There is…","html":"<h2>Introduction</h2>\n<p>Toasts are lightweight notifications designed to mimic the push notifications. They have been popularized by mobile and desktop operating systems. They’re used mainly internally, in-app to provide users with some feedback about errors, successfully completed actions, etc. There is plenty of techniques and different implementations, a lot of various packages to choose from. On the other hand, React introduced New Context API with version 16.3, which is quite robust and could be used in state management or even for displaying toasts.</p>\n<p>So I’m going to share a cool concept on how to add a notification system to a React Native application using Context API without any third-party packages. Yes, I will be using React Native here, but the concept still applies to plain React for the Web.</p>\n<h2>Let’s start</h2>\n<h3>Setup</h3>\n<p>Let’s set up a new project. I will be using a template with TypeScript, so you can see how it could be typed. Your environment should be prepared for React Native. You can look into the <a href=\"https://facebook.github.io/react-native/docs/getting-started\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">official guide</a>.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">npx react-native init ToasterApp --template react-native-template-typescript</code></pre></div>\n<p>And then run it. React Native uses Yarn by default.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">yarn</span> ios</code></pre></div>\n<h3>Simple app</h3>\n<p>Let’s remove the initial boilerplate code and set up a few simple screens using <a href=\"https://reactnavigation.org/en\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">react-navigation</a> to demonstrate how we can display toasts on no matter which screen. In the docs you can find a well-described Hello React Navigation guide, just follow the steps to set up the bare minimum. In my case, the simple app looks like this.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 650px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/201d64e1ef3060e262d764fbf928454c/64756/simple-app.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 107.97546012269939%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAWCAYAAADAQbwGAAAACXBIWXMAAAsTAAALEwEAmpwYAAADu0lEQVQ4y62V/08bdRjH7y/yBxOji/EbUxOTqfOnydxizIiLxOyHmRGixmnUOMVEhLiIomRjYxMxDhwbY7oJgzI1QGGljPZKv1y/f7lee71r79rey9yVMiCLEuOTvPI8d/e+5/O+X94naJpGOp3GLsuyaFZzVhSFRCKBYZik0xnq9fo2Xb3emItFlVAohGALqtXqpshenslkNpfGYjFnaT4vk8naBzd0spwjFpO4VxbVqolQq9WchU3K5bKDPVcqFewvsDXlskFMypOMq6TiqjNLYZlkvEgiViAuKajFCoL9ku3CtitJEpFIhGg06nxmsVhEUQqYpkEqoTI57uHK6DxXxxaZ+MXGzbXLS8zcEPl90ofHHW8sjEoSPp+PWDTmLLMPSCYSFAoF8nIewyg7Tq6PLzP20yzXr7j59eoyv03c4cY1D3NTAWepxx1DMEyTimlg1qsYNROz1uhG1aRsVNArZWr1KqmkyvTNEK5bErO3Ik53OT3C7HSYqZtBvJ4UQklR8c2v4Jv3bOv+RS+iexX/wgqlgkrNrJL0B0n7g6Q2sOfE2joJ3zrxVRE1m0eY+HaEE48d5sOXjnFy3xu8/3w7J/e18/YzbbzzbBvH97Qy8f0lalkJ/7kv8Z7v5e5QA++5HkIjfUQv9RMePk1mbhJhtGeQ9547SveRd+k61MGp1rf45MBxPnih3aGz5VVGv7qImVhneaAbV/8X3P6uG/fZXtxnegiM9BP+eYDgcB/J6XGEsd4h3nywlc6W1+l4so0TTxxx6Hiqjc69Rzn20EHGTg9jJIIEBrsJj3xDaPhrIj/2IW3MNuvne0hOXUZIBcNMDw4wc+EsM0NNzjT6hUGmBgdIBiNYpoF8dwl5bXkbubUlh6x3ET0dR7BSP2DdeRFWD4P3IJb3FSzvIayVl7FWWhvPUhfR6xAulAgr9wjKRSS1TFwziJYq5CpVBEPsojTbgr7wGtpfB9D/3I/+x34019Norr2Uph/GtDU18IQjzCwuc9uzilsMsugPIKayRBSVkKyQLGoIZuBztKkH0Oda0F2Po888ssEe9NlHnWfVQBdqFcRMDjEtI6ZzhPJFIkrJ6TbrcoGkqiHUlAUM30eY4qeY4ilM8bMtdGH4P6auzGPWIafp5PSKQ1Yrb5LTymS0MiXDRGAXZTWiZzdSBMuy8632LzQycDf8o8NmRjbFO0P4vg7/94U7xXaC74z5rZqt11tp3hd2uvmvDpv3tzm0/yd2YtukUqn7urGrVCqRy+WQZdkJ4a0O/wa5OzNdG6jaBwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Simple app screenshot\"\n        title=\"Simple app screenshot\"\n        src=\"/static/201d64e1ef3060e262d764fbf928454c/663f3/simple-app.png\"\n        srcset=\"/static/201d64e1ef3060e262d764fbf928454c/5e043/simple-app.png 163w,\n/static/201d64e1ef3060e262d764fbf928454c/e5cc6/simple-app.png 325w,\n/static/201d64e1ef3060e262d764fbf928454c/663f3/simple-app.png 650w,\n/static/201d64e1ef3060e262d764fbf928454c/d880f/simple-app.png 975w,\n/static/201d64e1ef3060e262d764fbf928454c/64756/simple-app.png 1200w\"\n        sizes=\"(max-width: 650px) 100vw, 650px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>It has 2 screens: <strong>Home</strong> and <strong>Details</strong>, from which we are going to trigger toasts.</p>\n<h2>Context implementation</h2>\n<h3>Portal Context</h3>\n<p><img src=\"/e7707fa70961a52bc47779f0c6a46dec/teleport.gif\" alt=\"Teleport\"></p>\n<p>Then let’s define our Context. It will have <code class=\"language-text\">gates</code>. They can accept our components somewhere in the tree hierarchy, for the demo there will be only one gate available – <code class=\"language-text\">toaster</code>. Then a <code class=\"language-text\">teleport</code> function that can send a component to a gate (a toast to the root component, in our case), and the <code class=\"language-text\">showToast</code> function for convenience. In general, we can use the <code class=\"language-text\">teleport</code> function for moving not only toasts through our React hierarchy.</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token comment\">// ./src/toaster/portalContext.tsx</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">type</span> <span class=\"token class-name\">ShowToastFunction</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>message<span class=\"token operator\">?</span><span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">,</span> type<span class=\"token operator\">?</span><span class=\"token operator\">:</span> ToastType<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token keyword\">void</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">type</span> <span class=\"token class-name\">PortalContextProps</span> <span class=\"token operator\">=</span> React<span class=\"token punctuation\">.</span>ContextType<span class=\"token operator\">&lt;</span><span class=\"token keyword\">typeof</span> PortalContext<span class=\"token operator\">></span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">type</span> <span class=\"token class-name\">GateName</span> <span class=\"token operator\">=</span> <span class=\"token string\">'toaster'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">interface</span> <span class=\"token class-name\">IContextProps</span> <span class=\"token punctuation\">{</span>\n  gates<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> <span class=\"token punctuation\">[</span>key<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">]</span><span class=\"token operator\">:</span> ReactNode <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n  <span class=\"token function-variable function\">teleport</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span>gateName<span class=\"token operator\">:</span> GateName<span class=\"token punctuation\">,</span> element<span class=\"token operator\">:</span> ReactNode<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token keyword\">void</span><span class=\"token punctuation\">;</span>\n  showToast<span class=\"token operator\">:</span> ShowToastFunction<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> PortalContext <span class=\"token operator\">=</span> <span class=\"token generic-function\"><span class=\"token function\">createContext</span><span class=\"token generic class-name\"><span class=\"token operator\">&lt;</span>IContextProps<span class=\"token operator\">></span></span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  gates<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token function-variable function\">teleport</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token function-variable function\">showToast</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h3>Portal Provider</h3>\n<p>Next let’s implement the business logic, for these purposes we create Portal Provider. With the the help of if, we can wrap our entire app and the logic will be available throughout the app.</p>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token comment\">// ./src/toaster/portalProvider.tsx</span>\n\n<span class=\"token keyword\">interface</span> <span class=\"token class-name\">IProviderProps</span> <span class=\"token punctuation\">{</span>\n  children<span class=\"token operator\">:</span> ReactNode<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">interface</span> <span class=\"token class-name\">IProviderState</span> <span class=\"token punctuation\">{</span>\n  gates<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> <span class=\"token punctuation\">[</span>key<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">]</span><span class=\"token operator\">:</span> ReactNode <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">PortalProvider</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">Component<span class=\"token operator\">&lt;</span>IProviderProps<span class=\"token punctuation\">,</span> IProviderState<span class=\"token operator\">></span></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">public</span> state <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n    gates<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">public</span> <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">PortalContext.Provider</span></span>\n        <span class=\"token attr-name\">value</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span>\n          gates<span class=\"token operator\">:</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>gates<span class=\"token punctuation\">,</span>\n          teleport<span class=\"token operator\">:</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>teleport<span class=\"token punctuation\">,</span>\n          showToast<span class=\"token operator\">:</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>showToast<span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span></span>\n      <span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n        </span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">.</span>children<span class=\"token punctuation\">}</span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">PortalContext.Provider</span></span><span class=\"token punctuation\">></span></span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">private</span> <span class=\"token function-variable function\">teleport</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>gateName<span class=\"token operator\">:</span> GateName<span class=\"token punctuation\">,</span> element<span class=\"token operator\">:</span> ReactNode<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">setState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>prevState<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n      gates<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> <span class=\"token operator\">...</span>prevState<span class=\"token punctuation\">.</span>gates<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span>gateName<span class=\"token punctuation\">]</span><span class=\"token operator\">:</span> element <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">private</span> showToast<span class=\"token operator\">:</span> ShowToastFunction <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>\n    message <span class=\"token operator\">=</span> <span class=\"token string\">'Oh là là! There is an error!'</span><span class=\"token punctuation\">,</span>\n    type <span class=\"token operator\">=</span> ToastType<span class=\"token punctuation\">.</span>Error\n  <span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">teleport</span><span class=\"token punctuation\">(</span><span class=\"token string\">'toaster'</span><span class=\"token punctuation\">,</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Toast</span></span> <span class=\"token attr-name\">type</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>type<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">{</span>message<span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">Toast</span></span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>The Provider’s state manages our gates and its components – exactly what we need. Under the hood the <code class=\"language-text\">teleport</code> function sets <code class=\"language-text\">gate</code>’s state value to a component that we would send.</p>\n<p>And finally the <code class=\"language-text\">showToast</code> function which is just a convenient method for us. It will be using the defined earlier <code class=\"language-text\">teleport</code> function and will send our actual <code class=\"language-text\">&lt;Toast /></code> component. There are 2 arguments: one for the message of the toast, the other for its type whether it’s <code class=\"language-text\">error</code>, <code class=\"language-text\">info</code> or <code class=\"language-text\">success</code>, etc. By default it has a generic error.</p>\n<h3>Portal Consumer</h3>\n<p>Then let’s move to the Context Consumer. In fact, the Consumer is our Gate. Nothing special here, just a render prop that displays the sent component as children.</p>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token comment\">// ./src/toaster/portalConsumer.tsx</span>\n\n<span class=\"token keyword\">interface</span> <span class=\"token class-name\">IPortalConsumerProps</span> <span class=\"token punctuation\">{</span>\n  gateName<span class=\"token operator\">:</span> GateName<span class=\"token punctuation\">;</span>\n  children<span class=\"token operator\">?</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span><span class=\"token function-variable function\">teleport</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span>gateName<span class=\"token operator\">:</span> GateName<span class=\"token punctuation\">,</span> element<span class=\"token operator\">:</span> ReactNode<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token keyword\">void</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> ReactNode<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">PortalConsumer</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> gateName<span class=\"token punctuation\">,</span> children <span class=\"token punctuation\">}</span><span class=\"token operator\">:</span> IPortalConsumerProps<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">PortalContext.Consumer</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n    </span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">(</span>value<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n        </span><span class=\"token punctuation\">{</span>value<span class=\"token punctuation\">.</span>gates<span class=\"token punctuation\">[</span>gateName<span class=\"token punctuation\">]</span><span class=\"token punctuation\">}</span><span class=\"token plain-text\">\n        </span><span class=\"token punctuation\">{</span>children <span class=\"token operator\">&amp;&amp;</span> <span class=\"token function\">children</span><span class=\"token punctuation\">(</span>value<span class=\"token punctuation\">.</span>teleport<span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span></span><span class=\"token punctuation\">></span></span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token plain-text\">\n  </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">PortalContext.Consumer</span></span><span class=\"token punctuation\">></span></span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h3>Bonus: useToaster hook</h3>\n<p>One more nice to have thing is a custom hook which we can use for getting the <code class=\"language-text\">showToast</code> function without repeating ourselves. It’s pretty simple and returns just the Context’s method. The method’s signature is automatically typed! So sweeet!</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token comment\">// ./src/toaster/useToaster.tsx</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">useToaster</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> showToast <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">useContext</span><span class=\"token punctuation\">(</span>PortalContext<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> <span class=\"token function\">useCallback</span><span class=\"token punctuation\">(</span>showToast<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h2>Enable the feature</h2>\n<p>Now we implemented everything that was necessary. Let’s enable it for our app!</p>\n<h3>Providing and Consuming</h3>\n<p>First wrap the app into <code class=\"language-text\">ContextProvider</code>. It should be at one level higher than the navigation, so we could see our toasts covering the app’s navigation bar.</p>\n<div class=\"gatsby-highlight has-highlighted-lines\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token comment\">// ./App.tsx</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">App</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n<span class=\"gatsby-highlight-code-line\">    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">PortalProvider</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\"></span></span><span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">StatusBar</span></span> <span class=\"token attr-name\">barStyle</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>dark-content<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">RootStackNavigationContainer</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token plain-text\"></span>\n<span class=\"gatsby-highlight-code-line\"><span class=\"token plain-text\">    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">PortalProvider</span></span><span class=\"token punctuation\">></span></span></span>  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Add the Gate for the toasts. It could be at the same level as our navigation – it is enough to display toasts on the navigation bar. Provide the name for the Gate, in this case it would be <code class=\"language-text\">toaster</code>.</p>\n<div class=\"gatsby-highlight has-highlighted-lines\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token comment\">// ./App.tsx</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">App</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">PortalProvider</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">StatusBar</span></span> <span class=\"token attr-name\">barStyle</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>dark-content<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token plain-text\"></span>\n<span class=\"gatsby-highlight-code-line\"><span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">PortalConsumer</span></span> <span class=\"token attr-name\">gateName</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>toaster<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token plain-text\"></span></span><span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">RootStackNavigationContainer</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">PortalProvider</span></span><span class=\"token punctuation\">></span></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h3>Teleporting</h3>\n<p>And finally we can use either <code class=\"language-text\">useToaster</code>, or even <code class=\"language-text\">contextType</code> (for class components) to trigger the much awaited toasts somewhere in the code. Let’s add them to our screens!</p>\n<h4>Functional component</h4>\n<div class=\"gatsby-highlight has-highlighted-lines\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token comment\">// ./src/navigation/screens.tsx</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">HomeScreen</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token keyword\">const</span> showToast <span class=\"token operator\">=</span> <span class=\"token function\">useToaster</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token comment\">// Or even without our custom hook we still can use the context directly,</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token comment\">// showToast is typed and correct!</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token comment\">// const { showToast } = useContext(PortalContext);</span></span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">View</span></span> <span class=\"token attr-name\">style</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>styles<span class=\"token punctuation\">.</span>screen<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\"></span>\n<span class=\"gatsby-highlight-code-line\"><span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Button</span></span> <span class=\"token attr-name\">onPress</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">showToast</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Message'</span><span class=\"token punctuation\">,</span> ToastType<span class=\"token punctuation\">.</span>Info<span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">Trigger toast</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">Button</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\"></span></span><span class=\"token plain-text\">      </span><span class=\"token punctuation\">{</span><span class=\"token comment\">/* Screen body ... */</span><span class=\"token punctuation\">}</span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">View</span></span><span class=\"token punctuation\">></span></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h4>Class component</h4>\n<div class=\"gatsby-highlight has-highlighted-lines\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token comment\">// ./src/navigation/screens.tsx</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">DetailsScreen</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">Component<span class=\"token operator\">&lt;</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token operator\">></span></span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> contextType <span class=\"token operator\">=</span> PortalContext<span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token comment\">// Necessary when using TypeScript, so this.context has correct types</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token keyword\">public</span> context<span class=\"token operator\">!</span><span class=\"token operator\">:</span> PortalContextProps<span class=\"token punctuation\">;</span></span>\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">View</span></span> <span class=\"token attr-name\">style</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>styles<span class=\"token punctuation\">.</span>screen<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\"></span>\n<span class=\"gatsby-highlight-code-line\"><span class=\"token plain-text\">        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Button</span></span> <span class=\"token attr-name\">onPress</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>context<span class=\"token punctuation\">.</span><span class=\"token function\">showToast</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Details message'</span><span class=\"token punctuation\">,</span> ToastType<span class=\"token punctuation\">.</span>Info<span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\"></span></span><span class=\"token plain-text\">          Trigger toast</span>\n<span class=\"token plain-text\">        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">Button</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">        </span><span class=\"token punctuation\">{</span><span class=\"token comment\">/* Screen body ... */</span><span class=\"token punctuation\">}</span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">View</span></span><span class=\"token punctuation\">></span></span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h3>Final touch</h3>\n<p>One more think left is to automatically clean up our toasts. It’s necessary to clean our gates before sending new toasts since it could cause rendering issues. So don’t forget to call <code class=\"language-text\">teleport</code> with <code class=\"language-text\">null</code> in the <code class=\"language-text\">onEndAnimation</code> callback.</p>\n<div class=\"gatsby-highlight has-highlighted-lines\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token comment\">// ./src/components/toast.tsx</span>\n\n<span class=\"token keyword\">private</span> <span class=\"token function-variable function\">endAnimation</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> animationXY<span class=\"token punctuation\">,</span> animationOpacity <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state\n\n  Animated<span class=\"token punctuation\">.</span><span class=\"token function\">parallel</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>\n    <span class=\"token comment\">// End animation...</span>\n  <span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">start</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">setState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> swipe<span class=\"token operator\">:</span> <span class=\"token boolean\">false</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"gatsby-highlight-code-line\">    <span class=\"token comment\">// We should clean up our toaster after the animation has ended</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>context<span class=\"token punctuation\">.</span><span class=\"token function\">teleport</span><span class=\"token punctuation\">(</span><span class=\"token string\">'toaster'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span></span>  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h2>And voilà!</h2>\n<p>Take a look at the demo. It works on both screens!</p>\n<!-- TODO: Replace with React component -->\n<p style=\"border-radius: 3px; overflow: hidden; line-height: 0; text-align: center;\">\n  <video controls style=\"max-width: 100%; max-height: 600px;\">\n    <source src=\"/e69f9a325acfc42dd3107a14d4fb97ff/toast-trigger.mp4\" type=\"video/mp4\" />\n  </video>\n</p>\n<!-- <Video sourceUrl=\"/e69f9a325acfc42dd3107a14d4fb97ff/toast-trigger.mp4\" title=\"Toast trigger\" isIFramed={false} /> -->\n<h2>Conclusion</h2>\n<p>In my opinion, this one is pretty amazing way to implement toasts display in the app and in React. Feel free to play with it and maybe you could find it useful for another use case, not only for toasters. The repo with the code is available on my <a href=\"https://github.com/ilyagru/react-context-toaster-app\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">GitHub</a>. Happy teleporting!</p>\n<!-- TODO: Replace with React component -->\n<p style=\"background-color: #f8f8fa; border-radius: 3px; line-height: 0;\">\n  <iframe\n    allow=\"autoplay *; encrypted-media *; fullscreen *\"\n    frameborder=\"0\"\n    height=\"150px\"\n    style=\"width:100%;overflow:hidden;background:transparent;min-height:150px;\"\n    sandbox=\"allow-forms allow-popups allow-same-origin allow-scripts allow-storage-access-by-user-activation allow-top-navigation-by-user-activation\" src=\"https://embed.music.apple.com/pl/album/%D1%82%D0%B5%D0%BB%D0%B5%D0%BF%D0%BE%D1%80%D1%82/1454458835?i=1454458852\">\n  </iframe>\n</p>\n<p><em>Sidenote: I spied the initial idea from <a href=\"https://medium.com/@naorzruk/portals-in-react-native-22797ba8aa1b\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Naor Zruk</a>, but then improved it a little bit and adapted for Notification system. Thanks Naor for inspiring me!</em></p>","frontmatter":{"title":"Toast messages mechanism in React Native using React Context","date":"February 13, 2020","summary":"A cool concept on how to add a notification system to a React Native application using React Context API without any third-party packages.","featuredImage":{"childImageSharp":{"gatsbyImageData":{"layout":"fixed","backgroundColor":"#6838b8","images":{"fallback":{"src":"/static/bced6a274ed612f07a82500114b10f3a/b5380/react-context-toaster-featured-image.png","srcSet":"/static/bced6a274ed612f07a82500114b10f3a/b5380/react-context-toaster-featured-image.png 1200w","sizes":"1200px"},"sources":[{"srcSet":"/static/bced6a274ed612f07a82500114b10f3a/81547/react-context-toaster-featured-image.webp 1200w","type":"image/webp","sizes":"1200px"}]},"width":1200,"height":630}}}}}},"pageContext":{"slug":"react-context-toaster","source":"blog","previous":{"fields":{"slug":"steps-for-localizing-react-native-app","source":"blog"},"frontmatter":{"title":"Steps for Localizing React Native App"}},"next":{"fields":{"slug":"cssattributedstring-in-swift","source":"blog"},"frontmatter":{"title":"CSSAttributedString in Swift"}}}},"staticQueryHashes":["3128451518","4268320825","637957696"]}